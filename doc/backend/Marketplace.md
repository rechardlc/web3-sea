# Marketplace åˆçº¦æ–‡æ¡£

## ğŸ“‹ æ¦‚è¿°

Marketplace æ˜¯ SEA GameFi é¡¹ç›®çš„ NFT äº¤æ˜“å¸‚åœºåˆçº¦ï¼Œæ”¯æŒç”¨æˆ·ä½¿ç”¨ SEA ä»£å¸ä¹°å–é±¼ç±» NFTï¼Œå¹¶å®ç°äº¤æ˜“æ‰‹ç»­è´¹çš„åˆ†é…åˆçº¦é”€æ¯æœºåˆ¶ã€‚

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

### 1. NFT äº¤æ˜“æœºåˆ¶

#### æŒ‚å•å‡ºå”®

- ç”¨æˆ·å¯ä»¥å°†è‡ªå·±çš„ NFT æŒ‚å•å‡ºå”®
- è®¾ç½® SEA ä»£å¸ä»·æ ¼
- NFT è½¬ç§»åˆ°å¸‚åœºåˆçº¦æ‰˜ç®¡
- å¯ä»¥éšæ—¶å–æ¶ˆæŒ‚å•æˆ–æ›´æ–°ä»·æ ¼

#### è´­ä¹° NFT

- ç”¨æˆ·ä½¿ç”¨ SEA ä»£å¸è´­ä¹°æŒ‚å•çš„ NFT
- è‡ªåŠ¨å¤„ç†æ‰‹ç»­è´¹åˆ†é…
- NFT è½¬ç§»ç»™ä¹°å®¶
- æŒ‚å•è‡ªåŠ¨ä¸‹æ¶

### 2. äº¤æ˜“æ‰‹ç»­è´¹

#### æ‰‹ç»­è´¹ç‡

- **æ€»æ‰‹ç»­è´¹ï¼š** 2%
- **åˆ†é…æ–¹å¼ï¼š**
  - 1% â†’ é”€æ¯ï¼ˆSEA ä»£å¸ï¼‰
  - 0.5% â†’ DAO èµ„é‡‘åº“
  - 0.5% â†’ æµåŠ¨æ€§æ± 
  - 98% â†’ å–å®¶

#### æ‰‹ç»­è´¹åˆ†é…ç¤ºä¾‹

å‡è®¾ NFT å”®ä»· 10,000 SEAï¼š

```
æ€»ä»·ï¼š10,000 SEA
â”œâ”€â”€ é”€æ¯ï¼š100 SEA (1%)
â”œâ”€â”€ DAOï¼š50 SEA (0.5%)
â”œâ”€â”€ æµåŠ¨æ€§æ± ï¼š50 SEA (0.5%)
â””â”€â”€ å–å®¶ï¼š9,800 SEA (98%)
```

## ğŸ”§ æ ¸å¿ƒå‡½æ•°

### æŒ‚å•å‡ºå”®

```solidity
function listNFT(uint256 tokenId, uint256 price) external
```

**åŠŸèƒ½ï¼š** å°† NFT æŒ‚å•å‡ºå”®

**å‚æ•°ï¼š**
- `tokenId` - NFT ID
- `price` - SEA ä»£å¸ä»·æ ¼ï¼ˆweiï¼‰

**æµç¨‹ï¼š**
1. æ£€æŸ¥ NFT æ‰€æœ‰æƒ
2. æ£€æŸ¥ä»·æ ¼æœ‰æ•ˆæ€§
3. æ£€æŸ¥æ˜¯å¦å·²æŒ‚å•
4. è½¬ç§» NFT åˆ°å¸‚åœºåˆçº¦
5. åˆ›å»ºæŒ‚å•ä¿¡æ¯

**äº‹ä»¶ï¼š** `NFTListed`

### è´­ä¹° NFT

```solidity
function buyNFT(uint256 tokenId) external
```

**åŠŸèƒ½ï¼š** è´­ä¹°æŒ‚å•çš„ NFT

**å‚æ•°ï¼š**
- `tokenId` - NFT ID

**æµç¨‹ï¼š**
1. æ£€æŸ¥æŒ‚å•æœ‰æ•ˆæ€§
2. æ£€æŸ¥ä¹°å®¶ä¸æ˜¯å–å®¶
3. æ£€æŸ¥ SEA ä½™é¢
4. è®¡ç®—æ‰‹ç»­è´¹
5. è½¬ç§» SEA ä»£å¸
6. é”€æ¯æ‰‹ç»­è´¹ï¼ˆ1%ï¼‰
7. åˆ†é…ç»™ DAO å’ŒæµåŠ¨æ€§æ± 
8. æ”¯ä»˜ç»™å–å®¶
9. è½¬ç§» NFT ç»™ä¹°å®¶
10. æ›´æ–°æŒ‚å•çŠ¶æ€

**äº‹ä»¶ï¼š** `NFTSold`

### å–æ¶ˆæŒ‚å•

```solidity
function cancelListing(uint256 tokenId) external
```

**åŠŸèƒ½ï¼š** å–æ¶ˆæŒ‚å•å¹¶å–å› NFT

**æƒé™ï¼š** ä»…å–å®¶å¯è°ƒç”¨

**æµç¨‹ï¼š**
1. æ£€æŸ¥æŒ‚å•æœ‰æ•ˆæ€§
2. æ£€æŸ¥è°ƒç”¨è€…æ˜¯å–å®¶
3. è¿”å› NFT ç»™å–å®¶
4. æ›´æ–°æŒ‚å•çŠ¶æ€

**äº‹ä»¶ï¼š** `ListingCancelled`

### æ›´æ–°æŒ‚å•ä»·æ ¼

```solidity
function updateListingPrice(uint256 tokenId, uint256 newPrice) external
```

**åŠŸèƒ½ï¼š** æ›´æ–°æŒ‚å•ä»·æ ¼

**æƒé™ï¼š** ä»…å–å®¶å¯è°ƒç”¨

**å‚æ•°ï¼š**
- `tokenId` - NFT ID
- `newPrice` - æ–°ä»·æ ¼ï¼ˆSEA ä»£å¸ï¼‰

**äº‹ä»¶ï¼š** `NFTListed`ï¼ˆæ›´æ–°äº‹ä»¶ï¼‰

## ğŸ“Š æ•°æ®ç»“æ„

### æŒ‚å•ä¿¡æ¯

```solidity
struct Listing {
    address seller;    // å–å®¶åœ°å€
    uint256 tokenId;   // NFT ID
    uint256 price;     // SEA ä»£å¸ä»·æ ¼
    uint256 listedAt;  // æŒ‚å•æ—¶é—´æˆ³
    bool active;       // æ˜¯å¦æ´»è·ƒ
}
```

### çŠ¶æ€å˜é‡

- `listings` - Token ID => æŒ‚å•ä¿¡æ¯
- `userListings` - ç”¨æˆ· => Token ID[]ï¼ˆç”¨æˆ·çš„æ‰€æœ‰æŒ‚å•ï¼‰
- `daoTreasury` - DAO èµ„é‡‘åº“åœ°å€
- `liquidityPool` - æµåŠ¨æ€§æ± åœ°å€

## ğŸ”’ å®‰å…¨æœºåˆ¶

### é‡å…¥æ”»å‡»é˜²æŠ¤

- ä½¿ç”¨ `nonReentrant` ä¿®é¥°ç¬¦
- é‡‡ç”¨ Checks-Effects-Interactions æ¨¡å¼

### æƒé™æ§åˆ¶

- ä»… NFT æ‰€æœ‰è€…å¯ä»¥æŒ‚å•
- ä»…å–å®¶å¯ä»¥å–æ¶ˆæˆ–æ›´æ–°æŒ‚å•
- Owner å¯ä»¥è®¾ç½® DAO å’ŒæµåŠ¨æ€§æ± åœ°å€

### æ•°å€¼éªŒè¯

- æ£€æŸ¥ä»·æ ¼æœ‰æ•ˆæ€§ï¼ˆ> 0ï¼‰
- æ£€æŸ¥ä½™é¢å……è¶³æ€§
- æ£€æŸ¥æŒ‚å•çŠ¶æ€

## ğŸ“ ä½¿ç”¨ç¤ºä¾‹

### æŒ‚å•å‡ºå”®

```javascript
// æŒ‚å•å‡ºå”® NFTï¼Œä»·æ ¼ 1000 SEA
const price = ethers.parseEther("1000");
await marketplace.listNFT(tokenId, price);
```

### è´­ä¹° NFT

```javascript
// è´­ä¹°æŒ‚å•çš„ NFT
await marketplace.buyNFT(tokenId);
```

### å–æ¶ˆæŒ‚å•

```javascript
// å–æ¶ˆæŒ‚å•
await marketplace.cancelListing(tokenId);
```

### æ›´æ–°ä»·æ ¼

```javascript
// æ›´æ–°æŒ‚å•ä»·æ ¼
const newPrice = ethers.parseEther("1500");
await marketplace.updateListingPrice(tokenId, newPrice);
```

### æŸ¥è¯¢æŒ‚å•ä¿¡æ¯

```javascript
// è·å–æŒ‚å•ä¿¡æ¯
const listing = await marketplace.getListing(tokenId);
console.log(`Seller: ${listing.seller}`);
console.log(`Price: ${ethers.formatEther(listing.price)} SEA`);
console.log(`Listed At: ${new Date(listing.listedAt * 1000)}`);
console.log(`Active: ${listing.active}`);

// è·å–ç”¨æˆ·çš„æ‰€æœ‰æŒ‚å•
const userListings = await marketplace.getUserListings(userAddress);
console.log(`User has ${userListings.length} listings`);
```

## ğŸ’° ç»æµæ¨¡å‹

### äº¤æ˜“æ‰‹ç»­è´¹é”€æ¯

- **é”€æ¯æ¯”ä¾‹ï¼š** 1%ï¼ˆäº¤æ˜“é‡‘é¢ï¼‰
- **ç›®çš„ï¼š** å‡å°‘ SEA ä»£å¸ä¾›åº”é‡
- **æ•ˆæœï¼š** é•¿æœŸé€šç¼©ï¼Œæå‡ä»£å¸ä»·å€¼

### DAO èµ„é‡‘åº“åˆ†é…

- **åˆ†é…æ¯”ä¾‹ï¼š** 0.5%ï¼ˆäº¤æ˜“é‡‘é¢ï¼‰
- **ç”¨é€”ï¼š**
  - æµåŠ¨æ€§æä¾›ï¼ˆ30%ï¼‰
  - å›è´­é”€æ¯ï¼ˆ30%ï¼‰
  - ç¤¾åŒºå¥–åŠ±ï¼ˆ20%ï¼‰
  - å¼€å‘è¿è¥ï¼ˆ15%ï¼‰
  - åº”æ€¥å‚¨å¤‡ï¼ˆ5%ï¼‰

### æµåŠ¨æ€§æ± åˆ†é…

- **åˆ†é…æ¯”ä¾‹ï¼š** 0.5%ï¼ˆäº¤æ˜“é‡‘é¢ï¼‰
- **ç”¨é€”ï¼š** æŒç»­æ³¨å…¥æµåŠ¨æ€§æ± ï¼Œæå‡äº¤æ˜“æ·±åº¦

## ğŸ”— ç›¸å…³åˆçº¦

- [FishNFT](./FishNFT.md) - äº¤æ˜“çš„ NFT åˆçº¦
- [SEAToken](./SEAToken.md) - äº¤æ˜“ä½¿ç”¨çš„ä»£å¸ï¼Œæ‰‹ç»­è´¹é”€æ¯

## ğŸ”® æœªæ¥æ‰©å±•

### è®¡åˆ’ä¸­çš„åŠŸèƒ½

1. **æ‹å–æœºåˆ¶** - æ”¯æŒæ‹å–æ¨¡å¼å‡ºå”® NFT
2. **æŠ¥ä»·ç³»ç»Ÿ** - ä¹°å®¶å¯ä»¥å¯¹ NFT è¿›è¡ŒæŠ¥ä»·
3. **æ‰¹é‡äº¤æ˜“** - æ”¯æŒæ‰¹é‡è´­ä¹°å¤šä¸ª NFT
4. **ä»·æ ¼å†å²** - è®°å½• NFT äº¤æ˜“å†å²
5. **ç¨€æœ‰åº¦ç­›é€‰** - æ ¹æ®ç¨€æœ‰åº¦ç­›é€‰ NFT
6. **ä»·æ ¼æ’åº** - æ”¯æŒæŒ‰ä»·æ ¼æ’åºæµè§ˆ

### å¯æ‰©å±•æ€§è®¾è®¡

- åˆçº¦æ¥å£è®¾è®¡æ”¯æŒæœªæ¥æ‰©å±•
- é¢„ç•™å‡çº§æœºåˆ¶
- æ¨¡å—åŒ–è®¾è®¡ä¾¿äºæ·»åŠ æ–°åŠŸèƒ½

## ğŸ“š å‚è€ƒæ–‡æ¡£

- [NFT å¸‚åœºè®¾è®¡æ–‡æ¡£](../../FishGameFi.md#ä¸‰sea-ä»£å¸è·å–ä¸æ¶ˆè€—æ¨¡å‹)
- [äº¤æ˜“æ‰‹ç»­è´¹æœºåˆ¶](../../FishGameFi.md#24-äº¤æ˜“è´¹ç”¨ä½é”€æ¯)

